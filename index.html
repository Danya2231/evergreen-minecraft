<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EverGreen Minecraft - Подать заявку</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --lime: #7CFC00;
  --lime-dark: #32CD32;
  --lime-light: #F0FFF0;
  --lime-super-light: #F8FFF8;
  --white: #FFFFFF;
  --black: #1A1A1A;
  --gray-light: #F5F5F5;
  --gray: #E0E0E0;
  --gray-dark: #666666;
  --red: #FF4444;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Inter', sans-serif;
  background: linear-gradient(135deg, var(--lime-light) 0%, var(--lime-super-light) 100%);
  color: var(--black);
  min-height: 100vh;
  opacity: 0;
  transition: opacity 0.8s ease-in;
}

.container {
  max-width: 500px;
  margin: 0 auto;
  padding: 20px;
  position: relative;
  z-index: 1;
}

.logo-container {
  text-align: center;
  margin: 10px 0 30px;
}

.logo {
  width: 100px;
  height: 100px;
  border-radius: 50%;
  border: 4px solid var(--lime);
  box-shadow: 0 8px 25px rgba(124, 252, 0, 0.4);
  padding: 6px;
  background-color: var(--white);
  transition: all 0.3s ease;
}

.logo:hover {
  transform: scale(1.05);
  box-shadow: 0 12px 35px rgba(124, 252, 0, 0.6);
}

/* ОСНОВНОЙ КАРД В СТИЛЕ КВАДРАТА */
.card {
  background-color: var(--white);
  padding: 40px 35px;
  border-radius: 25px;
  box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
  border: 3px solid var(--lime);
  margin-bottom: 25px;
  position: relative;
  overflow: hidden;
  min-height: 500px;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 6px;
  background: linear-gradient(90deg, var(--lime), var(--lime-dark));
}

.card-header {
  text-align: center;
  margin-bottom: 30px;
}

.card-header h1 {
  font-size: 2rem;
  margin-bottom: 15px;
  color: var(--black);
  font-weight: 700;
  background: linear-gradient(135deg, var(--lime), var(--lime-dark));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.card-header h2 {
  font-size: 1.6rem;
  color: var(--black);
  font-weight: 700;
  background: linear-gradient(135deg, var(--lime), var(--lime-dark));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.stats {
  display: flex;
  gap: 15px;
  justify-content: center;
  margin: 20px 0;
  flex-wrap: wrap;
}

.stat-card {
  background: var(--lime-light);
  padding: 15px 20px;
  border-radius: 18px;
  border-left: 4px solid var(--lime);
  text-align: center;
  flex: 1;
  min-width: 120px;
  box-shadow: 0 4px 15px rgba(124, 252, 0, 0.2);
}

.stat-number {
  font-size: 1.4rem;
  font-weight: 700;
  color: var(--lime-dark);
  display: block;
}

.stat-label {
  font-size: 0.8rem;
  color: var(--gray-dark);
  font-weight: 500;
}

/* Кнопки в лаймовом стиле */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, var(--lime), var(--lime-dark));
  color: var(--black);
  padding: 16px 32px;
  border: none;
  border-radius: 15px;
  font-family: 'Inter', sans-serif;
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  text-decoration: none;
  box-shadow: 0 6px 20px rgba(124, 252, 0, 0.4);
  gap: 10px;
  width: 100%;
  margin: 5px 0;
}

.btn:hover {
  transform: translateY(-3px);
  box-shadow: 0 10px 30px rgba(124, 252, 0, 0.6);
  background: linear-gradient(135deg, var(--lime-dark), #2EB82E);
}

.btn:active {
  transform: translateY(-1px);
  box-shadow: 0 4px 15px rgba(124, 252, 0, 0.4);
}

.btn-secondary {
  background: var(--white);
  color: var(--black);
  border: 2px solid var(--lime);
  box-shadow: 0 4px 15px rgba(124, 252, 0, 0.2);
}

.btn-secondary:hover {
  background: var(--lime-light);
  border-color: var(--lime-dark);
  box-shadow: 0 6px 20px rgba(124, 252, 0, 0.3);
}

.btn-danger {
  background: linear-gradient(135deg, var(--red), #FF3333);
  color: var(--white);
  box-shadow: 0 6px 20px rgba(255, 68, 68, 0.4);
}

.btn-danger:hover {
  background: linear-gradient(135deg, #FF3333, #FF1A1A);
  box-shadow: 0 10px 30px rgba(255, 68, 68, 0.6);
}

/* Формы */
.form-container {
  display: none;
}

.form-step {
  display: none;
  animation: fadeIn 0.5s ease-in-out;
}

.form-step.active {
  display: block;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.form-step h2 {
  font-size: 1.3rem;
  margin-bottom: 25px;
  color: var(--black);
  text-align: center;
  font-weight: 600;
  line-height: 1.4;
}

.form-group {
  margin-bottom: 20px;
}

.form-group label {
  display: block;
  margin-bottom: 8px;
  font-size: 0.9rem;
  font-weight: 600;
  color: var(--black);
}

.form-group input {
  width: 100%;
  padding: 15px 18px;
  border: 2px solid var(--gray);
  border-radius: 15px;
  font-family: 'Inter', sans-serif;
  font-size: 1rem;
  background-color: var(--white);
  transition: all 0.3s ease;
}

.form-group input:focus {
  outline: none;
  border-color: var(--lime);
  box-shadow: 0 0 0 3px rgba(124, 252, 0, 0.2);
  background-color: var(--white);
}

.form-navigation {
  display: flex;
  gap: 12px;
  margin-top: 30px;
}

.form-navigation .btn {
  flex: 1;
  min-width: auto;
}

.progress-container {
  margin: 25px 0 30px;
}

.progress-bar {
  height: 8px;
  background-color: var(--gray);
  border-radius: 10px;
  overflow: hidden;
  margin-bottom: 20px;
}

.progress {
  height: 100%;
  background: linear-gradient(90deg, var(--lime), var(--lime-dark));
  width: 0%;
  transition: width 0.5s ease-in-out;
  border-radius: 10px;
}

.progress-steps {
  display: flex;
  justify-content: space-between;
  margin-top: 15px;
}

.progress-step {
  font-size: 0.75rem;
  color: var(--gray-dark);
  font-weight: 500;
  text-align: center;
  flex: 1;
  position: relative;
}

.progress-step::before {
  content: '';
  position: absolute;
  top: -22px;
  left: 50%;
  transform: translateX(-50%);
  width: 16px;
  height: 16px;
  border-radius: 50%;
  background: var(--gray);
  border: 3px solid var(--white);
  z-index: 2;
  transition: all 0.3s ease;
}

.progress-step.active::before {
  background: var(--lime);
  box-shadow: 0 0 0 3px var(--lime-light);
}

.progress-step.active {
  color: var(--lime-dark);
  font-weight: 600;
}

/* Success message */
.success-message {
  display: none;
  text-align: center;
}

.success-content h2 {
  font-size: 1.5rem;
  margin-bottom: 15px;
  color: var(--black);
  font-weight: 700;
}

.success-content p {
  font-size: 0.95rem;
  line-height: 1.6;
  margin-bottom: 20px;
  color: var(--gray-dark);
}

.application-data {
  background-color: var(--lime-light);
  padding: 20px;
  border-radius: 18px;
  margin: 20px 0;
  text-align: left;
  font-size: 0.9rem;
  border-left: 4px solid var(--lime);
}

.application-data h3 {
  text-align: center;
  margin-bottom: 12px;
  color: var(--black);
  font-weight: 600;
}

.application-data p {
  margin: 6px 0;
  color: var(--gray-dark);
}

.application-data strong {
  color: var(--black);
  font-weight: 600;
}

/* Админ-панель */
.admin-container {
  display: none;
}

.admin-table-container {
  overflow-x: auto;
  margin: 20px 0;
  border-radius: 18px;
  border: 2px solid var(--lime);
  background: var(--white);
  box-shadow: 0 4px 15px rgba(124, 252, 0, 0.2);
  max-height: 400px;
  overflow-y: auto;
}

.admin-table {
  width: 100%;
  border-collapse: collapse;
  min-width: 600px;
}

.admin-table th {
  background: var(--lime-light);
  color: var(--black);
  font-weight: 600;
  padding: 14px 10px;
  text-align: left;
  border-bottom: 3px solid var(--lime);
  font-size: 0.75rem;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  position: sticky;
  top: 0;
}

.admin-table td {
  padding: 12px 10px;
  border-bottom: 1px solid var(--gray);
  font-size: 0.8rem;
  color: var(--black);
  vertical-align: top;
}

.admin-table tbody tr {
  transition: background-color 0.2s ease;
}

.admin-table tbody tr:hover {
  background-color: var(--lime-light);
}

.admin-table tbody tr:last-child td {
  border-bottom: none;
}

.app-id {
  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
  font-size: 0.7rem;
  color: var(--gray-dark);
  background: var(--lime-light);
  padding: 3px 6px;
  border-radius: 6px;
  display: inline-block;
}

.discord-tag {
  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
  font-size: 0.75rem;
  color: var(--lime-dark);
  font-weight: 500;
}

.minecraft-nick {
  font-weight: 600;
  color: var(--black);
}

.age-badge {
  background: var(--lime-light);
  color: var(--lime-dark);
  padding: 3px 8px;
  border-radius: 15px;
  font-size: 0.7rem;
  font-weight: 600;
  display: inline-block;
}

.youtube-link {
  color: var(--lime-dark);
  text-decoration: none;
  font-weight: 500;
  transition: color 0.2s ease;
  font-size: 0.75rem;
  display: inline-flex;
  align-items: center;
  gap: 4px;
}

.youtube-link:hover {
  color: var(--lime);
  text-decoration: underline;
}

.timestamp {
  font-size: 0.7rem;
  color: var(--gray-dark);
  white-space: nowrap;
}

.actions {
  display: flex;
  gap: 10px;
  margin-top: 20px;
  flex-wrap: wrap;
}

.action-buttons {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  width: 100%;
}

.action-buttons .btn {
  flex: 1;
  min-width: 140px;
}

.no-applications {
  text-align: center;
  padding: 50px 30px;
  color: var(--gray-dark);
  font-size: 1rem;
}

.no-applications svg {
  margin-bottom: 12px;
  opacity: 0.5;
}

.welcome-content {
  text-align: center;
  margin-bottom: 25px;
}

.welcome-content p {
  font-size: 1rem;
  line-height: 1.6;
  margin-bottom: 25px;
  color: var(--gray-dark);
  font-weight: 400;
}

/* АДАПТИВНОСТЬ ДЛЯ ТЕЛЕФОНОВ */
@media (max-width: 768px) {
  .container {
    padding: 15px;
    max-width: 100%;
  }
  
  .card {
    padding: 30px 25px;
    min-height: 450px;
    border-radius: 22px;
    margin-bottom: 20px;
  }
  
  .card-header h1 {
    font-size: 1.7rem;
  }
  
  .card-header h2 {
    font-size: 1.4rem;
  }
  
  .stats {
    gap: 10px;
  }
  
  .stat-card {
    padding: 12px 15px;
    min-width: 100px;
  }
  
  .stat-number {
    font-size: 1.2rem;
  }
  
  .stat-label {
    font-size: 0.7rem;
  }
  
  .btn {
    padding: 14px 25px;
    font-size: 0.95rem;
  }
  
  .form-step h2 {
    font-size: 1.2rem;
  }
  
  .progress-step {
    font-size: 0.7rem;
  }
  
  .form-navigation {
    flex-direction: column;
  }
  
  .admin-table th,
  .admin-table td {
    padding: 10px 8px;
    font-size: 0.7rem;
  }
  
  .action-buttons {
    flex-direction: column;
  }
  
  .action-buttons .btn {
    width: 100%;
  }
}

@media (max-width: 480px) {
  .logo {
    width: 80px;
    height: 80px;
  }
  
  .card {
    padding: 25px 20px;
    min-height: 420px;
    border-radius: 20px;
  }
  
  .card-header h1 {
    font-size: 1.5rem;
  }
  
  .card-header h2 {
    font-size: 1.3rem;
  }
  
  .stats {
    flex-direction: column;
    align-items: center;
  }
  
  .stat-card {
    width: 100%;
    max-width: 200px;
  }
  
  .welcome-content p {
    font-size: 0.95rem;
  }
  
  .form-group input {
    padding: 13px 15px;
  }
  
  .progress-step {
    font-size: 0.65rem;
  }
  
  .admin-container h2 {
    font-size: 1.3rem;
  }
}

@media (max-width: 360px) {
  .container {
    padding: 10px;
  }
  
  .card {
    padding: 20px 15px;
    min-height: 400px;
    border-radius: 18px;
  }
  
  .card-header h1 {
    font-size: 1.3rem;
  }
  
  .btn {
    padding: 12px 20px;
    font-size: 0.9rem;
  }
}
</style>
</head>
<body>
<div class="container" id="mainContent">
  <div class="logo-container">
    <img src="https://i.ibb.co/TqYqtF1h/logo.png" class="logo" alt="EverGreen">
  </div>

  <!-- Welcome Block -->
  <div class="card" id="welcomeBlock">
    <div class="card-header">
      <h1>Добро пожаловать на EverGreen!</h1>
    </div>
    <div class="stats">
      <div class="stat-card">
        <span class="stat-number" id="totalStats">0</span>
        <span class="stat-label">Всего заявок</span>
      </div>
      <div class="stat-card">
        <span class="stat-number" id="todayStats">0</span>
        <span class="stat-label">Сегодня</span>
      </div>
    </div>
    <div class="welcome-content">
      <p>Присоединяйтесь к нашему приватному Minecraft серверу. Чтобы стать частью сообщества, заполните заявку ниже.</p>
      <button class="btn" id="startBtn">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 5v14m-7-7h14"/>
        </svg>
        Подать заявку
      </button>
    </div>
  </div>

  <!-- Form Container -->
  <div class="card" id="formContainer">
    <div class="card-header">
      <h2>Заявка на вступление</h2>
    </div>
    
    <div class="progress-container">
      <div class="progress-bar"><div class="progress" id="progressBar"></div></div>
      <div class="progress-steps">
        <div class="progress-step active">Никнейм</div>
        <div class="progress-step">Возраст</div>
        <div class="progress-step">YouTube</div>
        <div class="progress-step">Discord</div>
      </div>
    </div>
    
    <form id="applicationForm">
      <div class="form-step active" id="step1">
        <h2>Какой у вас ник в Minecraft?</h2>
        <div class="form-group">
          <label>Введите ваш никнейм:</label>
          <input type="text" id="minecraftNick" required placeholder="Например: Steve42">
        </div>
        <div class="form-navigation">
          <button type="button" class="btn" id="nextBtn1">
            Далее
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M5 12h14m-7-7l7 7-7 7"/>
            </svg>
          </button>
        </div>
      </div>
      <div class="form-step" id="step2">
        <h2>Сколько вам лет?</h2>
        <div class="form-group">
          <label>Ваш возраст:</label>
          <input type="number" id="age" min="10" max="100" required placeholder="От 10 до 100">
        </div>
        <div class="form-navigation">
          <button type="button" class="btn btn-secondary" id="prevBtn2">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5m7 7l-7-7 7-7"/>
            </svg>
            Назад
          </button>
          <button type="button" class="btn" id="nextBtn2">
            Далее
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M5 12h14m-7-7l7 7-7 7"/>
            </svg>
          </button>
        </div>
      </div>
      <div class="form-step" id="step3">
        <h2>Ссылка на YouTube-видео</h2>
        <div class="form-group">
          <label>Вставьте ссылку на ваше видео:</label>
          <input type="url" id="youtubeLink" required placeholder="https://www.youtube.com/watch?v=...">
        </div>
        <div class="form-navigation">
          <button type="button" class="btn btn-secondary" id="prevBtn3">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5m7 7l-7-7 7-7"/>
            </svg>
            Назад
          </button>
          <button type="button" class="btn" id="nextBtn3">
            Далее
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M5 12h14m-7-7l7 7-7 7"/>
            </svg>
          </button>
        </div>
      </div>
      <div class="form-step" id="step4">
        <h2>Ваш ник в Discord</h2>
        <div class="form-group">
          <label>Discord никнейм:</label>
          <input type="text" id="discordNick" placeholder="User#1234" required>
        </div>
        <div class="form-navigation">
          <button type="button" class="btn btn-secondary" id="prevBtn4">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5m7 7l-7-7 7-7"/>
            </svg>
            Назад
          </button>
          <button type="submit" class="btn">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20 6L9 17l-5-5"/>
            </svg>
            Отправить заявку
          </button>
        </div>
      </div>
    </form>
  </div>

  <!-- Success Message -->
  <div class="card" id="successMessage">
    <div class="success-content">
      <h2>Заявка успешно отправлена!</h2>
      <p>Спасибо за вашу заявку на сервер EverGreen. Мы рассмотрим её в ближайшее время и свяжемся с вами в Discord.</p>
      <div class="application-data" id="applicationData"></div>
      <p>ID заявки: <strong id="applicationId"></strong></p>
      <button class="btn" id="newApplicationBtn">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 5v14m-7-7h14"/>
        </svg>
        Подать новую заявку
      </button>
    </div>
  </div>

  <!-- Admin Panel -->
  <div class="card" id="adminPanel">
    <div class="card-header">
      <h2>Панель администратора</h2>
    </div>
    <div class="stats">
      <div class="stat-card">
        <span class="stat-number" id="totalApplications">0</span>
        <span class="stat-label">Всего заявок</span>
      </div>
      <div class="stat-card">
        <span class="stat-number" id="todayApplications">0</span>
        <span class="stat-label">Сегодня</span>
      </div>
    </div>

    <div class="admin-table-container">
      <table class="admin-table" id="adminTable">
        <thead>
          <tr>
            <th style="width: 70px;">ID</th>
            <th style="width: 100px;">Игрок</th>
            <th style="width: 60px;">Возраст</th>
            <th style="width: 80px;">YouTube</th>
            <th style="width: 110px;">Discord</th>
            <th style="width: 120px;">Дата</th>
          </tr>
        </thead>
        <tbody id="adminTableBody">
          <!-- Данные будут загружены через JavaScript -->
        </tbody>
      </table>
    </div>

    <div class="actions">
      <div class="action-buttons">
        <button class="btn btn-danger" id="clearAppsBtn">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 6h18m-2 0v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/>
          </svg>
          Очистить все
        </button>
        <button class="btn btn-secondary" id="refreshAppsBtn">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M23 4v6h-6M1 20v-6h6"/>
            <path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"/>
          </svg>
          Обновить
        </button>
      </div>
    </div>
  </div>
</div>

<script>
// ==================== КОНФИГУРАЦИЯ ====================
const CONFIG = {
  ADMIN_PASSWORD: "EverGreenAdmin123",
  WELCOME_TITLE: "Добро пожаловать на EverGreen!",
  WELCOME_DESCRIPTION: "Присоединяйтесь к нашему приватному Minecraft серверу. Чтобы стать частью сообщества, заполните заявку ниже.",
  SERVER_NAME: "EverGreen"
};

// ==================== ОСНОВНОЙ КОД ====================

document.addEventListener('DOMContentLoaded', () => {
  document.body.style.opacity = '1';
  updateWelcomeStats();
  
  // Обновляем статистику каждые 5 секунд
  setInterval(updateWelcomeStats, 5000);
});

function updateWelcomeStats() {
  const apps = JSON.parse(localStorage.getItem('evergreenApplications') || '[]');
  document.getElementById('totalStats').textContent = apps.length;
  
  const today = new Date().toLocaleDateString('ru-RU');
  const todayApps = apps.filter(app => {
    const appDate = new Date(app.timestamp.split(',')[0]).toLocaleDateString('ru-RU');
    return appDate === today;
  });
  document.getElementById('todayStats').textContent = todayApps.length;
}

const urlParams = new URLSearchParams(window.location.search);
const isAdmin = urlParams.has('admin');

if (isAdmin) {
  document.getElementById('welcomeBlock').style.display = 'none';
  document.getElementById('formContainer').style.display = 'none';
  document.getElementById('successMessage').style.display = 'none';
  
  const pwd = prompt("Введите пароль администратора:");
  if (pwd !== CONFIG.ADMIN_PASSWORD) {
    alert('Неверный пароль!');
    window.location.href = window.location.pathname;
  } else {
    const adminDiv = document.getElementById('adminPanel');
    adminDiv.style.display = 'block';
    loadApplicationsTable();
    
    document.getElementById('clearAppsBtn').addEventListener('click', () => {
      if (confirm('Вы уверены, что хотите удалить ВСЕ заявки? Это действие нельзя отменить.')) {
        localStorage.removeItem('evergreenApplications');
        loadApplicationsTable();
        alert('Все заявки удалены');
      }
    });
    
    document.getElementById('refreshAppsBtn').addEventListener('click', loadApplicationsTable);
  }
} else {
  // Обычный пользовательский интерфейс
  const welcomeBlock = document.getElementById('welcomeBlock');
  const formContainer = document.getElementById('formContainer');
  const successMessage = document.getElementById('successMessage');
  const startBtn = document.getElementById('startBtn');
  const newApplicationBtn = document.getElementById('newApplicationBtn');
  const steps = document.querySelectorAll('.form-step');
  const progressBar = document.getElementById('progressBar');
  const stepLabels = document.querySelectorAll('.progress-step');
  const totalSteps = 4;
  let currentStep = 1;

  function updateProgressBar() {
    progressBar.style.width = ((currentStep - 1) / (totalSteps - 1) * 100) + '%';
    stepLabels.forEach((l, i) => l.classList.toggle('active', i < currentStep));
  }

  function goNext() {
    let valid = false;
    let errorMessage = '';
    
    switch (currentStep) {
      case 1:
        const nick = document.getElementById('minecraftNick').value.trim();
        valid = nick !== '';
        if (!valid) errorMessage = 'Введите ваш никнейм в Minecraft';
        else if (nick.length < 3) {
          valid = false;
          errorMessage = 'Никнейм должен содержать минимум 3 символа';
        }
        break;
      case 2:
        const ageVal = parseInt(document.getElementById('age').value);
        valid = !isNaN(ageVal) && ageVal >= 10 && ageVal <= 100;
        if (!valid) errorMessage = 'Введите корректный возраст (от 10 до 100 лет)';
        break;
      case 3:
        const yt = document.getElementById('youtubeLink').value.trim();
        valid = (yt !== '' && (yt.includes('youtube.com') || yt.includes('youtu.be')));
        if (!valid) errorMessage = 'Введите корректную ссылку на YouTube видео';
        break;
    }
    
    if (!valid) {
      alert(errorMessage);
      return;
    }
    
    if (currentStep < totalSteps) {
      steps[currentStep - 1].classList.remove('active');
      currentStep++;
      steps[currentStep - 1].classList.add('active');
      updateProgressBar();
    }
  }

  function goPrev() {
    if (currentStep > 1) {
      steps[currentStep - 1].classList.remove('active');
      currentStep--;
      steps[currentStep - 1].classList.add('active');
      updateProgressBar();
    }
  }

  document.getElementById('applicationForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const discord = document.getElementById('discordNick').value.trim();
    if (discord === '' || !discord.includes('#')) {
      alert('Введите корректный Discord никнейм (формат: User#1234)');
      return;
    }
    
    // Генерируем короткий ID
    const shortId = 'EG' + Math.random().toString(36).substr(2, 6).toUpperCase();
    
    const data = {
      id: shortId,
      minecraftNick: document.getElementById('minecraftNick').value.trim(),
      age: document.getElementById('age').value,
      youtubeLink: document.getElementById('youtubeLink').value.trim(),
      discordNick: discord,
      timestamp: new Date().toLocaleString('ru-RU')
    };
    
    let apps = JSON.parse(localStorage.getItem('evergreenApplications') || '[]');
    apps.push(data);
    localStorage.setItem('evergreenApplications', JSON.stringify(apps));
    
    document.getElementById('applicationData').innerHTML = `
      <h3>Данные вашей заявки</h3>
      <p><strong>Никнейм Minecraft:</strong> ${data.minecraftNick}</p>
      <p><strong>Возраст:</strong> ${data.age} лет</p>
      <p><strong>YouTube видео:</strong> <a href="${data.youtubeLink}" target="_blank" class="youtube-link">Ссылка</a></p>
      <p><strong>Discord:</strong> ${data.discordNick}</p>
    `;
    
    document.getElementById('applicationId').textContent = data.id;
    formContainer.style.display = 'none';
    successMessage.style.display = 'block';
    updateWelcomeStats();
  });

  startBtn.addEventListener('click', () => {
    welcomeBlock.style.display = 'none';
    formContainer.style.display = 'block';
  });
  
  newApplicationBtn.addEventListener('click', () => {
    document.getElementById('applicationForm').reset();
    steps.forEach(s => s.classList.remove('active'));
    document.getElementById('step1').classList.add('active');
    currentStep = 1;
    updateProgressBar();
    successMessage.style.display = 'none';
    formContainer.style.display = 'block';
  });

  document.getElementById('nextBtn1').addEventListener('click', goNext);
  document.getElementById('nextBtn2').addEventListener('click', goNext);
  document.getElementById('nextBtn3').addEventListener('click', goNext);
  document.getElementById('prevBtn2').addEventListener('click', goPrev);
  document.getElementById('prevBtn3').addEventListener('click', goPrev);
  document.getElementById('prevBtn4').addEventListener('click', goPrev);
}

function loadApplicationsTable() {
  const tbody = document.getElementById('adminTableBody');
  const apps = JSON.parse(localStorage.getItem('evergreenApplications') || '[]');
  
  // Обновляем статистику
  document.getElementById('totalApplications').textContent = apps.length;
  
  const today = new Date().toLocaleDateString('ru-RU');
  const todayApps = apps.filter(app => {
    const appDate = new Date(app.timestamp.split(',')[0]).toLocaleDateString('ru-RU');
    return appDate === today;
  });
  document.getElementById('todayApplications').textContent = todayApps.length;
  
  if (apps.length === 0) {
    tbody.innerHTML = `
      <tr>
        <td colspan="6" class="no-applications">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
            <path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
          </svg>
          <div>Нет заявок</div>
        </td>
      </tr>
    `;
  } else {
    tbody.innerHTML = '';
    apps.forEach(a => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td><span class="app-id">${a.id}</span></td>
        <td><span class="minecraft-nick">${a.minecraftNick}</span></td>
        <td><span class="age-badge">${a.age} лет</span></td>
        <td><a href="${a.youtubeLink}" target="_blank" class="youtube-link">Смотреть</a></td>
        <td><span class="discord-tag">${a.discordNick}</span></td>
        <td><span class="timestamp">${a.timestamp}</span></td>
      `;
      tbody.appendChild(tr);
    });
  }
}
</script>
</body>
</html>
